{"name":"Spell Activation","type":"script","scope":"global","author":"GR03rr8HdmGJJJsz","img":"icons/svg/dice-target.svg","command":"let tokenId = args[0].tokenId;\nlet mastery = args[0].item.system.attributes.mastery;\nlet active = args[1].active\n\nconst masteryToFile = {\n    \"arcana\": \"jb2a.magic_signs.circle.02.abjuration.complete.blue\",\n    \"aramancia\": \"jb2a.magic_signs.circle.02.evocation.complete.red\",\n    \"biomancia\": \"jb2a.magic_signs.circle.02.transmutation.complete.yellow\",\n    \"diastamancia\": \"jb2a.magic_signs.circle.02.divination.complete.blue\",\n    \"goetia\": \"jb2a.magic_signs.circle.02.enchantment.complete.pink\",\n    \"myalomancia\": \"jb2a.magic_signs.circle.02.illusion.complete.purple\",\n    \"necromancia\": \"jb2a.magic_signs.circle.02.necromancy.complete.green\",\n    \"theurgy\": \"jb2a.magic_signs.circle.02.conjuration.complete.yellow\"\n};\n\nconst file = masteryToFile[mastery];\nif (file === undefined) return;\n\nif (active) {\n    new Sequence()\n    .effect()\n        .file(masteryToFile[mastery])\n        .attachTo(tokenId)\n        .belowTokens()\n        .scaleToObject(2)\n        .fadeIn(1500, {ease: \"easeOutCubic\", delay: 500})\n        .fadeOut(1500)\n        .rotateIn(90, 2500, {ease: \"easeInOutCubic\"})\n        .rotateOut(350, 1500, {ease: \"easeInCubic\"})\n        .scaleIn(2, 2500, {ease: \"easeInOutCubic\"})\n        .scaleOut(0, 1500, {ease: \"easeInCubic\"})\n        .persist()\n        .name(`SpellActivation-${tokenId}`)\n    .play()\n}\nelse {\n    await Sequencer.EffectManager.endEffects({ name: `SpellActivation-${tokenId}` })\n}","ownership":{"default":0,"GR03rr8HdmGJJJsz":3},"flags":{"advanced-macros":{"runAsGM":true,"runForSpecificUser":""},"core":{"sourceId":"Macro.WyXBno1eq7O10P7x"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1683896228546,"modifiedTime":1684441995949,"lastModifiedBy":"P6Z2c3qOa4LQLGLN"},"folder":null,"sort":0,"_id":"Nnf8YJ2q06R9JduE"}
{"name":"Ice Cone","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/svg/dice-target.svg","command":"let templatePosition = {\n    x: args[1].document.x,\n    y: args[1].document.y\n}\nlet multiplier = 3;\nlet coneLength = args[1].document.distance + 1;\nlet offset = coneLength / 2;\nlet direction = 360 - args[1].document.direction;\n\nnew Sequence()\n    .effect()\n        .file(\"jb2a.cone_of_cold\")\n        .atLocation(templatePosition)\n        .spriteOffset({x: offset}, {gridUnits: true})\n        .size({width: coneLength, height: coneLength}, {gridUnits: true})\n        .rotate(direction)\n        .waitUntilFinished(-1000)\n    .sound()\n        .file(\"systems/pl1e/assets/sfx/spell-impact-1.mp3\")\n    .play()","ownership":{"default":0,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":true,"runForSpecificUser":""},"core":{"sourceId":"Macro.20tsan6vaZz7BBBa"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1684788794292,"modifiedTime":1684792289774,"lastModifiedBy":"P6Z2c3qOa4LQLGLN"},"folder":null,"sort":0,"_id":"USqm6TAHmkts7Uos"}
{"name":"Weapon Range Launch","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/svg/dice-target.svg","command":"let tokenId = args[0].tokenId;\nlet mastery = args[0].item.system.attributes.mastery;\nlet targetId = args[1].tokenId;\nlet missed = args[1].result === 0;\n\nconst masteryToFile = {\n    \"crossbows\": \"jb2a.bolt.physical.orange\",\n    \"bows\": \"jb2a.arrow.physical.blue\",\n    \"poleArms\": \"jb2a.dagger.throw.01\",\n    \"shortAxes\": \"jb2a.dagger.throw.01\",\n    \"shortBlades\": \"jb2a.dagger.throw.01\"\n};\n\nconst file = masteryToFile[mastery];\nif (file === undefined) {\n    file = \"jb2a.melee_generic\";\n}\n\nlet sequence = new Sequence()\n    .effect()\n        .file(file)\n        .atLocation(tokenId)\n        .stretchTo(targetId)\n        .randomizeMirrorY()\n        .missed(missed)\n    .play()","ownership":{"default":0,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":false,"runForSpecificUser":""},"core":{"sourceId":"Macro.hiMEI7aavjeyH67u"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1684438976540,"modifiedTime":1684442735803,"lastModifiedBy":"P6Z2c3qOa4LQLGLN"},"folder":null,"sort":0,"_id":"bE6g7eNRgOFRyjJr"}
{"name":"Weapon Melee Launch","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/svg/dice-target.svg","command":"let tokenId = args[0].tokenId;\nlet mastery = args[0].item.system.attributes.mastery;\nlet targetId = args[1].tokenId;\nlet missed = args[1].result === 0;\n\nconst masteryToFile = {\n    \"poleArms\": \"jb2a.spear.melee.01\",\n    \"shortAxes\": \"jb2a.melee_attack.02.handaxe.01\",\n    \"longAxes\": \"jb2a.melee_attack.03.trail.greataxe.01\",\n    \"shortBlades\": \"jb2a.melee_attack.01.shortsword.01\",\n    \"mediumBlades\": \"jb2a.melee_attack.01.shortsword.01\",\n    \"longBlades\": \"jb2a.melee_attack.03.trail.greatsword.01\",\n    \"shortHammers\": \"jb2a.melee_attack.02.hammer.02\",\n    \"longHammers\": \"jb2a.melee_attack.03.trail.maul.01\"\n};\n\nlet file = masteryToFile[mastery];\nif (file === undefined) {\n    file = \"jb2a.melee_generic\";\n}\n\nlet sequence = new Sequence()\n    .effect()\n        .file(file)\n        .atLocation(tokenId)\n        .stretchTo(targetId)\n        .randomizeMirrorY()\n        .missed(missed)\n    .play()","ownership":{"default":0,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":false,"runForSpecificUser":""},"core":{"sourceId":"Macro.EgIM9bFrm3I9dLcd"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1684436978216,"modifiedTime":1684542511849,"lastModifiedBy":"P6Z2c3qOa4LQLGLN"},"folder":null,"sort":0,"_id":"bMnmKFV3jNv3SiLM"}
{"name":"Magic Missile","type":"script","scope":"global","author":"GR03rr8HdmGJJJsz","img":"icons/svg/dice-target.svg","command":"let tokenId = args[0].tokenId;\nlet templatePosition = {\n    x: args[1].document.x,\n    y: args[1].document.y\n}\nlet speed = Math.random() * (1.2 - 0.8) + 0.8;\n\nnew Sequence()\n    .effect()\n        .file(\"jb2a.magic_missile\")\n        .playbackRate(speed)\n        .atLocation(tokenId)\n        .stretchTo(templatePosition)\n        .randomizeMirrorY()\n        .missed(false)\n        .waitUntilFinished(-1000)\n    .sound()\n        .file(\"systems/pl1e/assets/sfx/spell-impact-1.mp3\")\n    .play()","ownership":{"default":0,"GR03rr8HdmGJJJsz":3},"flags":{"advanced-macros":{"runAsGM":true,"runForSpecificUser":""},"core":{"sourceId":"Macro.IDQO2gr373FCcfVg"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1683842264920,"modifiedTime":1684777434712,"lastModifiedBy":"P6Z2c3qOa4LQLGLN"},"folder":null,"sort":0,"_id":"mI3RBDjyJRjhaNbP"}
{"name":"_Log Args","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/vtt-512.png","command":"// Copy the id of this macro into macro fields of the item to debug the output args\n\nconsole.log(args);","ownership":{"default":0,"GR03rr8HdmGJJJsz":3,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":false,"runForSpecificUser":""},"core":{"sourceId":"Macro.3LYkdOIeTqQWK8iF"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1683891596681,"modifiedTime":1684760020331,"lastModifiedBy":"WXEHs02TWAvnMbx1"},"folder":null,"sort":0,"_id":"pPbbGIyQaWjkP75s"}
{"name":"Fireball","type":"script","scope":"global","author":"WXEHs02TWAvnMbx1","img":"icons/svg/dice-target.svg","command":"let tokenId = args[0].tokenId;\nlet templatePosition = {\n    x: args[1].document.x,\n    y: args[1].document.y\n}\nlet cracksDiameter = args[1].document.distance * 3;\nlet explosionDiameter = args[1].document.distance * 3;\n\nnew Sequence()\n    .effect()\n        .file(\"jb2a.fireball.beam\")\n        .atLocation(tokenId)\n        .stretchTo(templatePosition)\n        .randomizeMirrorY()\n        .waitUntilFinished(-2000)\n    .sound()\n        .file(\"systems/pl1e/assets/sfx/hq-explosion-6288.mp3\")\n        .fadeInAudio(500)\n        .fadeOutAudio(500)\n    .effect()\n        .file(\"jb2a.impact.ground_crack.orange\")\n        .atLocation(templatePosition)\n        .belowTokens()\n        .size({width: cracksDiameter, height: cracksDiameter}, {gridUnits: true})\n        .randomizeMirrorY()\n        .fadeOut(2000)\n    .effect()\n        .file(\"jb2a.fireball.explosion\")\n        .atLocation(templatePosition)\n        .size({width: explosionDiameter, height: explosionDiameter}, {gridUnits: true})\n        .randomizeMirrorY()\n    .play()","ownership":{"default":0,"GR03rr8HdmGJJJsz":3,"WXEHs02TWAvnMbx1":3},"flags":{"advanced-macros":{"runAsGM":false,"runForSpecificUser":""},"core":{"sourceId":"Macro.IDQO2gr373FCcfVg"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1683842264920,"modifiedTime":1684768584625,"lastModifiedBy":"WXEHs02TWAvnMbx1"},"folder":null,"sort":0,"_id":"uDfuyR4XuCut54jZ"}
{"name":"Ice Cone","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/svg/dice-target.svg","command":"let templatePosition = {\n    x: args[1].document.x,\n    y: args[1].document.y\n}\nlet multiplier = 3;\nlet coneLength = args[1].document.distance + 1;\nlet offset = coneLength / 2;\nlet direction = 360 - args[1].document.direction;\n\nnew Sequence()\n    .effect()\n        .file(\"jb2a.cone_of_cold\")\n        .atLocation(templatePosition)\n        .spriteOffset({x: offset}, {gridUnits: true})\n        .size({width: coneLength, height: coneLength}, {gridUnits: true})\n        .rotate(direction)\n        .waitUntilFinished(-1000)\n        .shape(\"circle\", {\n            lineSize: 4,\n            lineColor: \"#FF0000\",\n            radius: 1.5,\n            gridUnits: true,\n            name: \"test\"\n        })\n    .sound()\n        .file(\"systems/pl1e/assets/sfx/spell-impact-1.mp3\")\n    .play()","ownership":{"default":0,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":true,"runForSpecificUser":""},"core":{"sourceId":"Macro.20tsan6vaZz7BBBa"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1684788794292,"modifiedTime":1684837164363,"lastModifiedBy":"WXEHs02TWAvnMbx1"},"folder":null,"sort":0,"_id":"USqm6TAHmkts7Uos"}
{"name":"Ice Cone","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/svg/dice-target.svg","command":"let templatePosition = {\n    x: args[1].document.x,\n    y: args[1].document.y\n}\nlet coneLength = args[1].document.distance + 1;\nlet offset = coneLength / 2;\nlet direction = 360 - args[1].document.direction;\n\nnew Sequence()\n    .effect()\n        .file(\"jb2a.cone_of_cold\")\n        .atLocation(templatePosition)\n        .spriteOffset({x: offset}, {gridUnits: true})\n        .size({width: coneLength, height: coneLength}, {gridUnits: true})\n        .rotate(direction)\n    .play()","ownership":{"default":0,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":true,"runForSpecificUser":""},"core":{"sourceId":"Macro.20tsan6vaZz7BBBa"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1684788794292,"modifiedTime":1684837249729,"lastModifiedBy":"WXEHs02TWAvnMbx1"},"folder":null,"sort":0,"_id":"USqm6TAHmkts7Uos"}
{"name":"Ice Cone","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/svg/dice-target.svg","command":"let templatePosition = {\n    x: args[1].document.x,\n    y: args[1].document.y\n}\nlet coneLength = args[1].document.distance;\nlet offset = coneLength / 2;\nlet direction = 360 - args[1].document.direction;\n\nnew Sequence()\n    .effect()\n        .file(\"jb2a.cone_of_cold\")\n        .atLocation(templatePosition)\n        .spriteOffset({x: offset}, {gridUnits: true})\n        .size({width: coneLength, height: coneLength}, {gridUnits: true})\n        .rotate(direction)\n    .play()","ownership":{"default":0,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":true,"runForSpecificUser":""},"core":{"sourceId":"Macro.20tsan6vaZz7BBBa"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1684788794292,"modifiedTime":1684837303697,"lastModifiedBy":"WXEHs02TWAvnMbx1"},"folder":null,"sort":0,"_id":"USqm6TAHmkts7Uos"}
{"name":"Ice Cone","type":"script","scope":"global","author":"P6Z2c3qOa4LQLGLN","img":"icons/svg/dice-target.svg","command":"let templatePosition = {\n    x: args[1].document.x,\n    y: args[1].document.y\n}\nlet coneLength = args[1].document.distance;\nlet offset = coneLength / 2;\nlet direction = 360 - args[1].document.direction;\n\nnew Sequence()\n    .effect()\n        .file(\"jb2a.cone_of_cold\")\n        .atLocation(templatePosition)\n        .belowTokens()\n        .spriteOffset({x: offset}, {gridUnits: true})\n        .size({width: coneLength, height: coneLength}, {gridUnits: true})\n        .rotate(direction)\n    .play()","ownership":{"default":0,"P6Z2c3qOa4LQLGLN":3},"flags":{"advanced-macros":{"runAsGM":true,"runForSpecificUser":""},"core":{"sourceId":"Macro.20tsan6vaZz7BBBa"}},"_stats":{"systemId":"pl1e","systemVersion":"1.2.0","coreVersion":"10.291","createdTime":1684788794292,"modifiedTime":1684837501345,"lastModifiedBy":"WXEHs02TWAvnMbx1"},"folder":null,"sort":0,"_id":"USqm6TAHmkts7Uos"}
